###############################
# Query for generating a search graph from object descriptions in dataset in dataset 'Associations'
###############################

PREFIX cc: <https://colonialcollections.nl/schema#> # Internal ontology
PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>
PREFIX la: <https://linked.art/ns/terms/>
PREFIX schema: <https://schema.org/>

CONSTRUCT {
  ?object a cc:HeritageObject ;
    cc:isPartOf ?datasetName ;
    cc:publisher ?publisherName .
}
WHERE {
  VALUES ?object {
    ?_iris
  }

  ####################
  # Part of dataset
  ####################

  # TODO: 'la:member_of' does not point to the dataset but to a graph
  # ?object la:member_of ?dataset .
  BIND(<https://colonial-heritage.triply.cc/nmvw/collection-archives> AS ?dataset)

  OPTIONAL {
    ?dataset schema:name ?datasetName
    FILTER(LANG(?datasetName) = "" || LANGMATCHES(LANG(?datasetName), "en"))
  }

  ####################
  # Publisher of dataset
  ####################

  OPTIONAL {
    ?dataset schema:publisher [
      schema:name ?publisherName ;
    ] .
  }
}
